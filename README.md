Я не уверен в том, что передача в Postgre работает правильно, так как я забыл выключить машину и у меня закончились все гранты.
Поэтому также утерян юпитер, в котором я считывал dataset через cli и создавал таблицы в hive.
Но передача в hive вроде как проходила исправно.

В DAGe планировалось три таска, один для считывания данных в hive, второй для подклбчения к Postgre, третий для передачи данных из hive в Postgre, еще возможно думал реализовать запуск спарк-сессии отдельным таском, но так и не понял нужно ли это на практике, а также очищение таблиц отдельным таском, но ограничился использованием overwrite.

Первый таск считывает данные из датасета, приводит дату в привычный вид и меняет тип данных.
После чего меняются имена колонок для заполнения в hive и данные рассылаются по трем таблицам, вызывается xcom, который выводит количество вставленных строк.

Второй таск проверяет подключение к бд Postgre.

Третий - считывает данные в датафрейм за последний месяц из hive и загружает через jbdc в postgre.

Спасибо большое за курс было полезно и весело!
